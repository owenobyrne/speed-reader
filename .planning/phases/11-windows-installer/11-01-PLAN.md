---
phase: 11-windows-installer
plan: 01
type: execute
---

<objective>
Configure NSIS installer settings with start menu shortcuts, uninstaller, and proper metadata.

Purpose: Create a professional Windows installer with user-friendly installation experience, start menu integration, and clean uninstallation.
Output: Fully configured NSIS installer ready to generate Windows .exe installer package.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-build-configuration/10-01-SUMMARY.md
@package.json

**Tech stack available:** electron-builder@26.4.0, NSIS target configured
**Established patterns:** electron-builder config in package.json build field
**Phase context:**
- electron-builder installed with Windows NSIS target
- App icon already configured (build/icons/icon.ico)
- Basic build metadata present (copyright, compression)
- Need to add NSIS-specific installer configuration
</context>

<tasks>

<task type="auto">
  <name>Task 1: Configure NSIS installer options</name>
  <files>package.json</files>
  <action>Add nsis configuration object to the build.win section in package.json. Include: oneClick:false (let users choose install location), allowToChangeInstallationDirectory:true, createDesktopShortcut:true, createStartMenuShortcut:true, installerIcon:"build/icons/icon.ico", uninstallerIcon:"build/icons/icon.ico", license:"LICENSE" (if LICENSE file exists, otherwise omit). Use perMachine:false for per-user installation (safer, no admin required). Set shortcutName to "Speed Reader".</action>
  <verify>package.json has build.win.nsis object with installer configuration options</verify>
  <done>NSIS installer configured with shortcuts, icons, and user-friendly installation options</done>
</task>

<task type="auto">
  <name>Task 2: Add installer metadata</name>
  <files>package.json</files>
  <action>Update package.json metadata fields that NSIS uses: set author field to appropriate value (can use empty string "" if no specific author), ensure productName is "Speed Reader" (already set), ensure description is present. Add publisher field in build section (use same as author or "Speed Reader"). This metadata appears in Windows Add/Remove Programs.</action>
  <verify>package.json has author, build.publisher fields, productName and description confirmed</verify>
  <done>Installer metadata complete for Windows Add/Remove Programs display</done>
</task>

<task type="auto">
  <name>Task 3: Test NSIS installer configuration</name>
  <files>None (verification only)</files>
  <action>Run npm run build to verify NSIS configuration is valid. electron-builder will validate the NSIS settings and generate the installer. Check that build completes without NSIS configuration errors. Note: On WSL/Linux, this may build Linux targets; the important validation is that NSIS config doesn't cause errors. Configuration will be fully tested when building on Windows in Phase 12.</action>
  <verify>npm run build completes without NSIS configuration errors</verify>
  <done>NSIS configuration validated, no syntax or schema errors</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] build.win.nsis configuration exists with installer options
- [ ] Installer metadata (author, publisher) configured
- [ ] npm run build validates without NSIS errors
- [ ] Configuration ready for Windows installer generation
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- NSIS installer fully configured
- Ready for Phase 12 (Distribution Package generation)
  </success_criteria>

<output>
After completion, create `.planning/phases/11-windows-installer/11-01-SUMMARY.md`:

# Phase 11 Plan 1: Windows Installer Summary

**[Substantive one-liner - what shipped, not "phase complete"]**

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified

- `path/to/file.ts` - Description
- `path/to/another.ts` - Description

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Phase Readiness

[Ready for Phase 12: Distribution Package]
</output>
