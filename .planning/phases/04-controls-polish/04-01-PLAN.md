---
phase: 04-controls-polish
plan: 01
type: execute
---

<objective>
Implement full keyboard controls for the RSVP reader: play/pause, speed adjustment, and font size control.

Purpose: Enable hands-free reading control without mouse interaction.
Output: All core controls accessible via keyboard shortcuts.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior phase summaries:
@.planning/phases/02-core-reader/02-01-SUMMARY.md
@.planning/phases/03-file-handling/03-02-SUMMARY.md

# Key files to modify:
@renderer.js
@styles.css

**Tech stack available:** electron@40, pdf-parse@1.1.1, mammoth, @mozilla/readability, jsdom
**Established patterns:** IPC architecture, state object in renderer.js, play()/pause() functions

**Constraining decisions:**
- ORP at 40% into word
- Default 300 WPM
- Speed range 100-1000 WPM (from PROJECT.md)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add keyboard handler for play/pause and speed control</name>
  <files>renderer.js</files>
  <action>
1. Add keydown event listener in DOMContentLoaded:
   - Space: toggle play/pause (call play() if paused, pause() if playing)
   - Up Arrow: increase WPM by 50 (max 1000)
   - Down Arrow: decrease WPM by 50 (min 100)

2. Create setSpeed(wpm) function:
   - Update state.wpm
   - If currently playing, restart interval with new delay
   - Show brief speed indicator (e.g., "350 WPM" for 1 second)

3. Add speed indicator element to show current WPM when changed:
   - Position at bottom of screen
   - Fade out after 1 second
   - Style: small, unobtrusive text

4. Prevent default for Space (avoid page scroll) and arrow keys
  </action>
  <verify>Press Space to pause/resume, Up/Down to change speed - speed indicator shows briefly</verify>
  <done>Space toggles playback, arrows adjust speed 100-1000 WPM in 50 WPM increments</done>
</task>

<task type="auto">
  <name>Task 2: Add font size adjustment</name>
  <files>renderer.js, styles.css</files>
  <action>
1. Add to state: fontSize: 48 (current default)

2. Add keyboard handlers:
   - Plus key (+/=): increase font size by 8px (max 96px)
   - Minus key (-): decrease font size by 8px (min 24px)

3. Create setFontSize(size) function:
   - Update state.fontSize
   - Apply to word-display element via style
   - Show brief size indicator (e.g., "56px")

4. Update styles.css:
   - Change word-display font-size from fixed 48px to use CSS variable or inherit from JS
  </action>
  <verify>Press +/- to change font size - text size changes, indicator shows briefly</verify>
  <done>Font size adjustable 24-96px in 8px increments via +/- keys</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete keyboard controls for RSVP reader</what-built>
  <how-to-verify>
    1. Run: npm start (from Windows command prompt)
    2. Drop a PDF or paste a URL to load content
    3. Test play/pause: Press Space - playback should toggle
    4. Test speed: Press Up Arrow - speed indicator shows increased WPM, words appear faster
    5. Test speed: Press Down Arrow - speed indicator shows decreased WPM, words appear slower
    6. Test speed limits: Keep pressing Down - should stop at 100 WPM
    7. Test speed limits: Keep pressing Up - should stop at 1000 WPM
    8. Test font size: Press + key - text gets larger, indicator shows size
    9. Test font size: Press - key - text gets smaller
    10. Confirm: Speed/size indicators fade out after ~1 second
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] npm start runs without errors
- [ ] Space toggles play/pause
- [ ] Up/Down arrows adjust speed (100-1000 WPM range)
- [ ] +/- keys adjust font size (24-96px range)
- [ ] Indicators show briefly then fade
</verification>

<success_criteria>

- All keyboard shortcuts working
- Speed limits enforced (100-1000 WPM)
- Font size limits enforced (24-96px)
- Visual feedback for all adjustments
- No interference with existing functionality
</success_criteria>

<output>
After completion, create `.planning/phases/04-controls-polish/04-01-SUMMARY.md`
</output>
