---
phase: 06-font-system
plan: 01
type: execute
---

<objective>
Implement font cycling system with locally-bundled Google Fonts.

Purpose: Give users choice of serif fonts for comfortable reading. Fonts bundled locally for offline support.
Output: "f" key cycles through 6 fonts, preference saved to localStorage.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/05-reading-timing/05-01-SUMMARY.md
@renderer.js
@styles.css
@index.html

**Fonts to support (from roadmap):**
- Times New Roman (default, local - already in use)
- Tinos (Google Font)
- EB Garamond (Google Font)
- Merriweather (Google Font)
- Libre Baskerville (Google Font)
- Spectral (Google Font)

**Key constraint:** App must work offline. Bundle .woff2 files locally, don't use CDN.

**Existing patterns:**
- state object in renderer.js holds all app state
- Keyboard handlers in DOMContentLoaded switch statement
- showIndicator() for feedback on key presses
- localStorage used for position saving (same pattern for font preference)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Download and bundle Google Fonts</name>
  <files>fonts/, styles.css</files>
  <action>
    1. Create fonts/ directory in project root
    2. Use google-webfonts-helper or direct download to get .woff2 files for: Tinos, EB Garamond, Merriweather, Libre Baskerville, Spectral (regular weight only, 400)
    3. Add @font-face declarations to styles.css for each font, pointing to local files
    4. Format: @font-face { font-family: 'FontName'; src: url('fonts/fontname.woff2') format('woff2'); font-weight: 400; font-style: normal; font-display: swap; }

    Use npm package `get-google-fonts` to download, or download manually from Google Fonts GitHub. Either approach works.
  </action>
  <verify>All 5 .woff2 files exist in fonts/. CSS has 5 @font-face rules.</verify>
  <done>Font files bundled locally, @font-face declarations added to styles.css</done>
</task>

<task type="auto">
  <name>Task 2: Implement font cycling with persistence</name>
  <files>renderer.js</files>
  <action>
    1. Add to state: fonts array ['Times New Roman', 'Tinos', 'EB Garamond', 'Merriweather', 'Libre Baskerville', 'Spectral'], currentFontIndex: 0
    2. Create setFont(index) function:
       - Updates state.currentFontIndex
       - Sets body and word-display font-family to state.fonts[index] with serif fallback
       - Shows indicator with font name
       - Saves to localStorage('speed-reader-font')
    3. Create cycleFont() function: increments currentFontIndex (mod fonts.length), calls setFont
    4. Add keyboard handler for 'KeyF' that calls cycleFont()
    5. On DOMContentLoaded: restore font from localStorage if saved, otherwise default to Times New Roman (index 0)

    Pattern follows existing cycleTimingMode() and setSpeed() for consistency.
  </action>
  <verify>Press 'f' key - font changes and indicator shows font name. Reload app - font preference persists.</verify>
  <done>Font cycles through all 6 options with 'f' key. Preference persists across sessions.</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] All 5 Google Font .woff2 files present in fonts/
- [ ] @font-face declarations in styles.css
- [ ] 'f' key cycles through all 6 fonts
- [ ] Font preference persists after app restart
- [ ] All fonts render correctly (no fallback to system serif)
- [ ] npm start runs without errors
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No console errors about missing fonts
- Font cycling works offline (disconnect internet, fonts still load)
</success_criteria>

<output>
After completion, create `.planning/phases/06-font-system/06-01-SUMMARY.md` using summary template.
</output>
